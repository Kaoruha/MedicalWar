(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"3e5f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("h4",[t._v(t._s(t.game_name))]),a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:"https://cdn.quasar.dev/img/parallax2.jpg"}},[a("div",{staticClass:"absolute-bottom"},[a("div",{staticClass:"text-h6"},[t._v(t._s(t.company_name))]),a("div",{staticClass:"text-subtitle2"},[t._v("Current Round ："+t._s(t.rounds))])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col info"},[t._v("总资金："+t._s(t.capital-t.hc_price*t.total_hc-t.channel_price*t.total_channel-t.permission_price*t.total_permission-t.info_price*t.total_info))]),a("div",{staticClass:"col"},[t._v("可分配人数："+t._s(t.hc_limit-t.total_hc))]),a("div",{staticClass:"col"},[t._v("人力成本:"+t._s(t.hc_price))]),a("div",{staticClass:"col"},[t._v("渠道牌价格："+t._s(t.channel_price))]),a("div",{staticClass:"col"},[t._v("渠道牌数量："+t._s(t.channel_count-t.total_channel))]),a("div",{staticClass:"col"},[t._v("准入牌价格："+t._s(t.permission_price))]),a("div",{staticClass:"col"},[t._v("准入牌数量："+t._s(t.permission_count-t.total_permission))]),a("div",{staticClass:"col"},[t._v("信息牌价格："+t._s(t.info_price))]),a("div",{staticClass:"col"},[t._v("信息牌数量："+t._s(t.info_count-t.total_info))]),a("div",{staticClass:"col"},[t._v("营收："+t._s(t.profit))])])],1),a("q-table",{staticClass:"my-sticky-virtscroll-table",attrs:{"virtual-scroll":"",pagination:t.pagination,"rows-per-page-options":[0],"virtual-scroll-sticky-size-start":48,"row-key":"id",title:"Strategy",data:t.data,columns:t.columns},on:{"update:pagination":function(e){t.pagination=e},request:t.onRequest},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-btn",{staticClass:"btn-add",attrs:{color:"primary",rounded:"",icon:"skip_next",label:"Next Round"},on:{click:function(e){t.is_submit_show=!0}}})]},proxy:!0},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"name",attrs:{props:e}},[t._v(t._s(e.row.name))]),a("q-td",{key:"operation_count",attrs:{props:e}},[t._v(t._s(e.row.operation_count))]),a("q-td",{key:"hc",attrs:{props:e}},[t._v(t._s(e.row.hc))]),a("q-td",{key:"advertising",attrs:{props:e}},[t._v(t._s(e.row.advertising))]),a("q-td",{key:"a_price",attrs:{props:e}},[t._v(t._s(e.row.a_price))]),a("q-td",{key:"a_share",attrs:{props:e}},[t._v(t._s(e.row.a_share))]),a("q-td",{key:"b_price",attrs:{props:e}},[t._v(t._s(e.row.b_price))]),a("q-td",{key:"b_share",attrs:{props:e}},[t._v(t._s(e.row.b_share))]),a("q-td",{key:"c_price",attrs:{props:e}},[t._v(t._s(e.row.c_price))]),a("q-td",{key:"c_share",attrs:{props:e}},[t._v(t._s(e.row.c_share))]),a("q-td",{key:"hc_strategy",attrs:{props:e}},[t._v("\n          "+t._s(e.row.hc_strategy)+"\n          "),a("q-popup-edit",{attrs:{title:"Update HC",buttons:"",persistent:""},model:{value:e.row.info,callback:function(a){t.$set(e.row,"info",a)},expression:"props.row.info"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.hc_strategy,callback:function(a){t.$set(e.row,"hc_strategy",a)},expression:"props.row.hc_strategy"}})],1)],1),a("q-td",{key:"advertising_strategy",attrs:{props:e}},[t._v("\n          "+t._s(e.row.advertising_strategy)+"\n          "),a("q-popup-edit",{attrs:{title:"Update Advertising",buttons:"",persistent:""},model:{value:e.row.advertising_strategy,callback:function(a){t.$set(e.row,"advertising_strategy",a)},expression:"props.row.advertising_strategy"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.advertising_strategy,callback:function(a){t.$set(e.row,"advertising_strategy",a)},expression:"props.row.advertising_strategy"}})],1)],1),a("q-td",{key:"a_strategy",attrs:{props:e}},[t._v("\n          "+t._s(e.row.a_strategy)+"\n          "),a("q-popup-edit",{attrs:{title:"Update A Price",buttons:"",persistent:""},model:{value:e.row.a_strategy,callback:function(a){t.$set(e.row,"a_strategy",a)},expression:"props.row.a_strategy"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.a_strategy,callback:function(a){t.$set(e.row,"a_strategy",a)},expression:"props.row.a_strategy"}})],1)],1),a("q-td",{key:"b_strategy",attrs:{props:e}},[t._v("\n          "+t._s(e.row.b_strategy)+"\n          "),a("q-popup-edit",{attrs:{title:"Update B Price",buttons:"",persistent:""},model:{value:e.row.b_strategy,callback:function(a){t.$set(e.row,"b_strategy",a)},expression:"props.row.b_strategy"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.b_strategy,callback:function(a){t.$set(e.row,"b_strategy",a)},expression:"props.row.b_strategy"}})],1)],1),a("q-td",{key:"c_strategy",attrs:{props:e}},[t._v("\n          "+t._s(e.row.c_strategy)+"\n          "),a("q-popup-edit",{attrs:{title:"Update C Price",buttons:"",persistent:""},model:{value:e.row.c_strategy,callback:function(a){t.$set(e.row,"c_strategy",a)},expression:"props.row.c_strategy"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.c_strategy,callback:function(a){t.$set(e.row,"c_strategy",a)},expression:"props.row.c_strategy"}})],1)],1),a("q-td",{key:"channel",attrs:{props:e}},[t._v("\n          "+t._s(e.row.channel)+"\n          "),a("q-popup-edit",{attrs:{title:"Update Channel",buttons:"",persistent:""},model:{value:e.row.channel,callback:function(a){t.$set(e.row,"channel",a)},expression:"props.row.channel"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.channel,callback:function(a){t.$set(e.row,"channel",a)},expression:"props.row.channel"}})],1)],1),a("q-td",{key:"permission",attrs:{props:e}},[t._v("\n          "+t._s(e.row.permission)+"\n          "),a("q-popup-edit",{attrs:{title:"Update Permission",buttons:"",persistent:""},model:{value:e.row.permission,callback:function(a){t.$set(e.row,"permission",a)},expression:"props.row.permission"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.permission,callback:function(a){t.$set(e.row,"permission",a)},expression:"props.row.permission"}})],1)],1),a("q-td",{key:"info",attrs:{props:e}},[t._v("\n          "+t._s(e.row.info)+"\n          "),a("q-popup-edit",{attrs:{title:"Update Info",buttons:"",persistent:""},model:{value:e.row.info,callback:function(a){t.$set(e.row,"info",a)},expression:"props.row.info"}},[a("q-input",{attrs:{type:"number",dense:"",autofocus:"",hint:"Use buttons to close"},model:{value:e.row.info,callback:function(a){t.$set(e.row,"info",a)},expression:"props.row.info"}})],1)],1)],1)]}}])}),a("q-dialog",{attrs:{persistent:""},model:{value:t.is_submit_show,callback:function(e){t.is_submit_show=e},expression:"is_submit_show"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("结束回合")])]),a("q-card-section",{staticClass:"q-pt-none del-dialog"},[a("p",{staticClass:"msg"},[t._v("你确定提交第"+t._s(t.rounds)+"回合策略么？")])]),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"green",label:"Submit"},on:{click:function(e){return t.submit()}}})],1)],1)],1)],1)},r=[],i=(a("99af"),a("4de4"),a("4160"),a("caad"),a("fb6a"),a("4e82"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("448a")),s=a.n(i),o=a("89cb"),c={name:"Game_player",data:function(){return{total_channel:0,total_permission:0,total_info:0,total_hc:0,total_advertising:0,uuid:"",game_id:1,game_name:"",rounds:1,company_id:"a",capital:0,hc_limit:0,hc_price:1e3,channel_count:10,channel_price:1100,permission_count:11,permission_price:1010,info_count:12,info_price:1001,profit:0,is_submit_show:!1,ready_to_submit:{id:0,name:"god"},company_name:"公司12",filter:"",loading:!1,pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:0,rowsNumber:10},columns:[{name:"name",required:!0,label:"医院名称",align:"left",field:function(t){return t.name},style:"width: 10px",headerStyle:"width: 10px",format:function(t){return"".concat(t)},sortable:!0},{name:"operation_count",required:!0,label:"年手术台数",align:"left",field:function(t){return t.operation_count},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"hc",required:!0,label:"当前HC",align:"left",field:function(t){return t.hc},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"advertising",required:!0,label:"推广费用",align:"left",field:function(t){return t.advertising},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"a_price",required:!0,label:"产品A价格",align:"left",field:function(t){return t.a_price},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"a_share",required:!1,label:"产品A份额",align:"left",field:function(t){return t.a_share},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"b_price",required:!1,label:"产品B价格",align:"left",field:function(t){return t.b_price},style:"width:200px",format:function(t){return"".concat(t)},sortable:!1},{name:"b_share",required:!0,label:"产品B份额",align:"left",field:function(t){return t.b_share},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"c_price",required:!0,label:"产品C价格",align:"left",field:function(t){return t.c_price},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"c_share",required:!0,label:"产品C份额",align:"left",field:function(t){return t.c_share},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"hc_strategy",required:!0,label:"HC决策",align:"left",field:function(t){return t.hc_strategy},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"advertising_strategy",required:!0,label:"推广决策",align:"left",field:function(t){return t.advertising_strategy},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"a_strategy",required:!0,label:"产品A价格决策",align:"left",field:function(t){return t.a_strategy},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"b_strategy",required:!0,label:"产品B价格决策",align:"left",field:function(t){return t.b_strategy},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"c_strategy",required:!0,label:"产品C价格决策",align:"left",field:function(t){return t.c_strategy},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"channel",required:!0,label:"渠道牌",align:"left",field:function(t){return t.channel},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"permission",required:!0,label:"准入牌",align:"left",field:function(t){return t.permission},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0},{name:"info",required:!0,label:"信息牌",align:"left",field:function(t){return t.info},style:"width:200px",format:function(t){return"".concat(t)},sortable:!0}],data:[],original:[]}},mounted:function(){this.get_uuid(),this.get_current_game_info()},watch:{data:{handler:function(t,e){this.int_pars(),this.calculate()},deep:!0}},methods:{onRequest:function(t){var e=this,a=t.pagination,n=a.page,r=a.rowsPerPage,i=a.sortBy,o=a.descending,c=t.filter;this.loading=!0,this.get_company_data(c,o),setTimeout((function(){var t;e.pagination.rowsNumber=e.getRowsNumberCount(c);var a=0===r?e.pagination.rowsNumber:r,l=(n-1)*r,u=e.fetchFromServer(l,a,c,i,o);(t=e.data).splice.apply(t,[0,e.data.length].concat(s()(u))),e.pagination.page=n,e.pagination.rowsPerPage=r,e.pagination.sortBy=i,e.pagination.descending=o,e.loading=!1}),1500)},fetchFromServer:function(t,e,a,n,r){var i=a?this.original.filter((function(t){return t.account.includes(a)})):this.original.slice();if(n){var s="id"===n?r?function(t,e){return t.name>e.name?-1:t.name<e.name?1:0}:function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}:r?function(t,e){return parseFloat(e[n])-parseFloat(t[n])}:function(t,e){return parseFloat(t[n])-parseFloat(e[n])};i.sort(s)}return i.slice(t,t+e)},getRowsNumberCount:function(t){if(!t)return this.original.length;var e=0;return this.original.forEach((function(a){a.account.includes(t)&&++e})),e},get_company_data:function(t,e){this.original=[];var a=this;o["a"].GetCompanyData(this.game_id,this.company_id,this.rounds).then((function(t){var e=t.data;console.log(e);for(var n=0;n<e.length;n++)a.original.push({name:e[n].name,operation_count:e[n].operation_count,hc_sensitivity:e[n].hc_sensitivity,advertising_sensitivity:e[n].advertising_sensitivity,price_sensitivity:e[n].price_sensitivity,hc:e[n].hc,share:e[n].share,hc_low_limit:e[n].hc_low_limit,advertising:e[n].advertising,a_price:e[n].a_price,a_mean:e[n].a_mean,a_share:e[n].a_share,b_price:e[n].b_price,b_mean:e[n].b_mean,b_share:e[n].b_share,c_price:e[n].c_price,c_mean:e[n].c_mean,c_share:e[n].c_share,hc_strategy:e[n].hc_strategy,advertising_strategy:e[n].advertising_strategy,a_strategy:e[n].a_strategy,b_strategy:e[n].b_strategy,c_strategy:e[n].c_strategy,channel:e[n].channel,permission:e[n].permission,info:e[n].info})}))},clear_add_dialog:function(){this.account="",this.password=""},show_delete_dialog:function(t,e){this.is_delete_show=!0,this.ready_to_delete.id=t,this.ready_to_delete.name=e},get_company_info:function(){var t=this;o["a"].GetCompanyInfo(this.game_id,this.rounds).then((function(e){var a=e.data;console.log(a);var n=0;switch(t.company_id){case"a":n=0;break;case"b":n=1;break;case"c":n=2;break;case"d":n=3;break;default:break}t.capital=a[n].capital,t.hc_limit=a[n].hc_limit,t.hc_price=a[n].hc_price,t.channel_price=a[n].channel_price,t.channel_count=a[n].channel,t.permission_price=a[n].permission_price,t.permission_count=a[n].permission,t.info_price=a[n].info_price,t.info_count=a[n].info,t.profit=a[n].profit}))},get_uuid:function(){var t=this.get_query_string("uuid");this.uuid=t},get_query_string:function(t){var e=window.location.href,a=e.split(t+"=")[1];return a},get_current_game_info:function(){var t=this,e=this;o["a"].QueryByUUID(this.uuid).then((function(a){var n=a.data;console.log(n),e.game_id=n.game_id,e.company_id=n.company_id,e.company_name="Company "+e.company_id,e.rounds=n.player_rounds,e.game_name=n.name,e.onRequest({pagination:t.pagination,filter:t.filter}),e.get_company_info()}))},submit:function(){o["a"].Submit(this.game_id,this.company_id,this.rounds,this.data).then((function(t){switch(t.code){default:break;case 200:alert("提交成功");break}}))},int_pars:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.hc=Math.round(e.hc),e.advertising=Number(e.advertising).toFixed(2),e.a_price=Number(e.a_price).toFixed(2),e.a_share=Number(e.a_share).toFixed(2),e.b_price=Number(e.b_price).toFixed(2),e.b_share=Number(e.b_share).toFixed(2),e.c_price=Number(e.c_price).toFixed(2),e.c_share=Number(e.c_share).toFixed(2),e.hc_strategy=Math.round(e.hc_strategy),e.advertising_strategy=Number(e.advertising_strategy).toFixed(2),e.a_strategy=Number(e.a_strategy).toFixed(2),e.b_strategy=Number(e.b_strategy).toFixed(2),e.c_strategy=Number(e.c_strategy).toFixed(2),e.channel=Math.round(e.channel),e.permission=Math.round(e.permission),e.info=Math.round(e.info)}},calculate:function(){var t=this;this.total_hc=0,this.total_advertising=0,this.total_permission=0,this.total_channel=0,this.total_info=0;for(var e=0;e<this.data.length;e++){var a=this.data[e];t.total_hc+=Number(a.hc_strategy),t.total_advertising+=Number(a.advertising_strategy),t.total_permission+=Number(a.permission),t.total_channel+=Number(a.channel),t.total_info+=Number(a.info)}}}},l=c,u=(a("86fc"),a("a605"),a("2877")),p=a("f09f"),_=a("068f"),d=a("eaac"),f=a("27f9"),h=a("0016"),m=a("9c40"),g=a("bd08"),b=a("db86"),y=a("42a1"),v=a("24e8"),w=a("a370"),q=a("4b7e"),k=a("7f67"),x=a("eebe"),C=a.n(x),N=Object(u["a"])(l,n,r,!1,null,"18ee915c",null);e["default"]=N.exports;C()(N,"components",{QCard:p["a"],QImg:_["a"],QTable:d["a"],QInput:f["a"],QIcon:h["a"],QBtn:m["a"],QTr:g["a"],QTd:b["a"],QPopupEdit:y["a"],QDialog:v["a"],QCardSection:w["a"],QCardActions:q["a"]}),C()(N,"directives",{ClosePopup:k["a"]})},"86fc":function(t,e,a){"use strict";var n=a("97b5"),r=a.n(n);r.a},"89cb":function(t,e,a){"use strict";var n=a("970b"),r=a.n(n),i=a("5bc3"),s=a.n(i),o=a("ed6d"),c=a.n(o),l=a("2d0d"),u=a.n(l),p=a("a417"),_="api/game",d=function(t){c()(a,t);var e=u()(a);function a(){return r()(this,a),e.call(this,_,3e3)}return s()(a,[{key:"Create",value:function(t,e){return this.post("/register",{name:t,description:e})}},{key:"Filter",value:function(t,e){return this.post("/filter",{start_row:0,count:2e3,account_filter:t,sort_by:"id",descending:e})}},{key:"Delete",value:function(t){return this.post("/delete",{uid:t})}},{key:"Submit",value:function(t,e,a,n){return this.post("/submit",{game_id:t,company_id:e,rounds:a,data:n})}},{key:"GetCompanyData",value:function(t,e,a){return this.post("/get_com_data",{game_id:t,company_id:e,rounds:a})}},{key:"GetCompanyInfo",value:function(t,e){return this.post("/get_com_info",{game_id:t,rounds:e})}},{key:"GetGameInfo",value:function(t){return this.post("/get_game_info",{game_id:t})}},{key:"Next",value:function(t,e){return this.post("/next",{game_id:t,data:e})}},{key:"Start",value:function(t){return this.post("/start",{game_id:t})}},{key:"QueryByUUID",value:function(t){return this.post("/query_by_uuid",{uuid:t})}}]),a}(p["a"]);e["a"]=new d},"97b5":function(t,e,a){},a417:function(t,e,a){"use strict";a("d3b7"),a("e6cf");var n=a("970b"),r=a.n(n),i=a("5bc3"),s=a.n(i),o=a("bc3a"),c=a.n(o),l=a("a18c"),u=function(){function t(e,a){r()(this,t),this.url=e,this.timeout=a,this.instance=c.a.create({baseURL:this.url,timeout:this.timeout,headers:{"Content-Type":"application/json;charset=UTF-8",Authorization:localStorage.getItem("Authorization")}}),this.instance.interceptors.request.use((function(t){return t.headers.Authorization=localStorage.getItem("Authorization"),t}),(function(t){return Promise.reject(t)})),this.instance.interceptors.response.use((function(t){switch(t.data.code){case 200:console.log("信息获取成功");break;case 403:console.log("权限不足,权限不足"),l["a"].push("/login");break;case 600:console.log("表单信息错误");break;case 601:console.log("用户名重复");break;case 602:console.log("登录失败");break}return t.data}),(function(t){return Promise.reject(t)}))}return s()(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.get(t,e)}},{key:"post",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.instance.post(t,e,a)}},{key:"upload",value:function(t,e){return this.instance.post(t,e,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"put",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.instance.put(t,e,a)}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.delete(t,e)}}]),t}();e["a"]=u},a5e9:function(t,e,a){},a605:function(t,e,a){"use strict";var n=a("a5e9"),r=a.n(n);r.a}}]);